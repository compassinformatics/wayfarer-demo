import"./bootstrap.min-fc66521f.js";import{V as k,a as F,T as g,F as w,S as d,b as S,C as h,D as v,p as E,c as T,d as I,G as m,e as L,k as A,f as C,M as G,g as N,h as j,R as O,i as P,t as R}from"./networklayer-bc81f725.js";import{T as V,O as D}from"./OSM-f284ffe5.js";import{g as _,c as M,a as B}from"./networkeditor-92112fc0.js";import{u as J,c as X}from"./table-29786adc.js";import{S as Y}from"./Select-2bf6977a.js";let u;function z(){s.getSource().clear()}function H(e,n){let o;return e.getGeometry().getType()==="LineString"?o=new g({font:"10px Open Sans",fill:new w({color:"#000"}),stroke:new d({color:"#fff",width:3}),offsetX:0,offsetY:-12,textAlign:"center",textBaseline:"middle"}):o=new g({text:e.get("index").toString(),font:"14px Open Sans",offsetX:0,offsetY:0,textAlign:"center",textBaseline:"middle"}),new S({stroke:new d({color:"#ff1dce",width:2}),text:o,image:new h({radius:12,fill:new w({color:"#ff1dce"})})})}const s=new k({source:new F,style:H});function q(){s.getSource().forEachFeature(function(e){e.getGeometry().getType()==="LineString"&&s.getSource().removeFeature(e)})}function K(e,n,o){let t=T([n]);const a=e.getView().getResolution()*3;return t=I(t,a),o.getSource().getFeaturesInExtent(t).length>0}function Q(e){if(Object.keys(e).length!==0){q();const o=new m().readFeatures(e);s.getSource().addFeatures(o),J(o,u,s)}}function U(e,n,o){const t=e.feature,a=t.getGeometry().getCoordinates(),r=n.getSource().getClosestFeatureToCoordinate(a);if(r){const c=p().length,l=r.getId();return t.set("edgeId",l),t.set("index",c),!0}return!1}function p(){const e=[];return s.getSource().forEachFeature(function(n){n.getGeometry().getType()==="Point"&&e.push(n)}),e}function W(e){const n=p();if(n.length>=2){const o=new m,t=JSON.stringify({points:o.writeFeatures(n),edits:_()});L("solve_shortest_path_from_points",t,Q)}}function Z(e,n){e.addLayer(s);const o=new v({source:s.getSource(),type:"Point",condition:function(t){return E(t)===!0?K(e,t.coordinate,n):!1}});return s.getSource().on("addfeature",function(t){t.feature.getGeometry().getType()==="Point"&&W()}),u=new Y({layers:[s],style:function(t,a){return new S({stroke:new d({color:"#00ffff",width:2})})}}),u.setActive(!1),e.addInteraction(u),o.on("drawend",function(t){U(t,n)}),o}function $(){const e="./data/stbrice.json",o=A([2.3314107610246633,48.988440397479536,2.4050093789098863,49.01280894618151],"EPSG:4326","EPSG:3857"),a=C(e,null,"rgba(255, 255, 255, 0.0)");X();const r=new G({target:"map",layers:[new V({source:new D}),a],view:new N({center:j(o),extent:o,zoom:16})});function c(){[i,f].forEach(function(b){b.setActive(!1)})}const l=[{text:"Hide/Show Labels",callback:R},"-",{text:"Activate Route Solver",callback:function(){c(),i.setActive(!0)}},{text:"Clear Routes",callback:z},"-",{text:"Activate Network Editor",callback:function(){c(),f.setActive(!0)}},{text:"Clear Network Edits",callback:B},"-"],x=new O({width:170,defaultItems:!0,items:l});r.addControl(x);const f=M(r,a),i=Z(r,a);r.addInteraction(i),r.addInteraction(f),c(),i.setActive(!0);const y=new P({source:a.getSource()});r.addInteraction(y)}$();
//# sourceMappingURL=routes-b2893611.js.map
